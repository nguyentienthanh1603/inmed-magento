<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Top menu for store
 *
 * @see Mage_Page_Block_Html_Topmenu
 */
?>
<?php
/** @var $this Bubble_CmsTree_Block_Page_Html_Topmenu */
$_cmsIsFirst = !$this->hasCategoriesNavigationMenuPages();
$_categoriesIsLast = !$this->hasCmsNavigationMenuPages();
$_menu  = $this->renderCategoriesMenuHtmlBubble(0, $_categoriesIsLast, true, 'level-top');

//var_dump($_menu);
/**
 * hack to get own products dropdown
 */
// @todo: check for current url and make active






$active = '';
$prod = '';
$ingred = '';
$cats = '';

$cont = '';
$stories = '';
$media = '';
$inter = '';
$active_2 = '';

$urlString = Mage::helper('core/url')->getCurrentUrl();
$url = Mage::getSingleton('core/url')->parseUrl($urlString);

if (strpos($url->getPath(),'products') == 1 )
{
	$active = ' active';
	$prod = ' active';
}
if (strpos($url->getPath(),'ingredients') == 1 )
{
	$active = ' active';
	$ingred = ' active';
}
if (strpos($url->getPath(),'categories') == 1 )
{
	$active = ' active';
	$cats = ' active';
}


if (strpos($url->getPath(),'contributors') == 1 )
{
	$active_2 = ' active';
	$cont = ' active';
}
if (strpos($url->getPath(),'stories') == 1 )
{
	$active_2 = ' active';
	$stories = ' active';
}
if (strpos($url->getPath(),'media') == 1 )
{
	$active_2 = ' active';
	$media = ' active';
}

if (strpos($url->getPath(),'interviews') == 1 )
{
	$active_2 = ' active';
	$inter = ' active';
}



$_menu = '<li class="level0'.$active.' nav-1 level-top first parent">
<a href="'.Mage::getBaseUrl().'products/?q=all" class="level-top">
<span>Products</span>
</a>
<ul class="level0 dropdown-menu">
<li class="level1'.$prod.' nav-1-1 first">
<a href="'.Mage::getBaseUrl().'products/?q=all">
<span>Name</span>
</a>
</li><li class="level1'.$ingred.' nav-1-2">
<a href="'.Mage::getBaseUrl().'ingredients">
<span>Ingredients</span>
</a>
</li>
<li class="level1'.$cats.' nav-1-3">
<a href="'.Mage::getBaseUrl().'categories">
<span>Categories</span>
</a>
</li>
<li class="level1'.$cats.' nav-1-4 last">
<a href="'.Mage::getBaseUrl().'product-faq">
<span>Product FAQ\'s</span>
</a>
</li>
</ul>
</li>';

$_menu .= '<li class="level0'.$active_2.' nav-1 level-top first parent">
<a href="'.Mage::getBaseUrl().'im-listening" class="level-top">
<span>IM Listening</span>
</a>
<ul class="level0 dropdown-menu">
<li class="level1'.$stories.' nav-1-1 first">
<a href="'.Mage::getBaseUrl().'im-listening/stories">
<span>Stories</span>
</a>
</li><li class="level1'.$inter.' nav-1-2">
<a href="'.Mage::getBaseUrl().'im-listening/interviews">
<span>Interviews</span>
</a>
</li>
<li class="level1'.$media.' nav-1-3 last">
<a href="'.Mage::getBaseUrl().'im-listening/multimedia">
<span>Media</span>
</a>
</li>
<li class="level1'.$cont.' nav-1-3 last">
<a href="'.Mage::getBaseUrl().'im-listening/contributors">
<span>Contributors</span>
</a>
</li>
</ul>
</li>';

if ($this->shouldRenderPages()) {
	$_menu .= $this->renderCmsMenuHtml(0, true, $_cmsIsFirst, 'level-top');
}

// blog
$_menu .= '<li class="level0'.$active_2.' nav-1 level-top first parent blog">
<a href="'.Mage::getBaseUrl().'blog" class="level-top">
<span>Blog</span>
</a>
<ul class="level0 dropdown-menu">
<li class="level1'.$stories.' nav-5-1 first">
<a href="'.Mage::getBaseUrl().'blog/stories">
<span>Probiotics</span>
</a>
</li><li class="level1'.$inter.' nav-5-2">
<a href="'.Mage::getBaseUrl().'blog/health-technology">
<span>Health Technology</span>
</a>
</li>
<li class="level1'.$media.' nav-5-3">
<a href="'.Mage::getBaseUrl().'blog/practitioner">
<span>Practitioner</span>
</a>
</li>
<li class="level1'.$cont.' nav-5-3">
<a href="'.Mage::getBaseUrl().'blog/med-trends">
<span>Med Trends</span>
</a>
</li>
<li class="level1'.$cont.' nav-5-4 last">
<a href="'.Mage::getBaseUrl().'blog/self-health">
<span>Self Health</span>
</a>
</li>
</ul>
</li>';

// add the cart
$_menu .= '<li class="level0'.$active_2.' nav-1 level-top first parent your-cart">
<a href="'.Mage::getBaseUrl().'checkout/cart/" class="level-top">
<span>Your Cart</span>
</a>
</li>';

$_menu .= '<li class="level0'.$active_2.' nav-1 level-top first parent account-details">
<a href="'.Mage::getBaseUrl().'customer/account/" class="level-top">
<span>Account Details</span>
</a>
</li>';

?>

<?php if ($_menu): ?>
	<div class="navbar_wrapper">
		<div class="container" >

			<nav class="navbar navbar-default navbar-main" role="navigation">
				<div class="navbar-header">
					<h1 class="header-logo-mobile">
						<a class="header-logo-mobile" href="<?php echo $this->getUrl(''); ?>">
							<img src="<?php echo $this->getSkinUrl('images/logo.png') ?>">
						</a>
					</h1>
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
						<span class="sr-only"><?php echo $this->__('Toggle Navigation') ?></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>

				<h1 class="header-logo-desktop">
					<a href="<?php echo $this->getUrl(''); ?>">
						<img src="<?php echo $this->getSkinUrl('images/logo.png') ?>">
					</a>
				</h1>


				<div class="collapse navbar-collapse navbar-main-collapse">



					<ul class="nav navbar-nav">
						<?php echo $_menu ?>
					</ul>

				</div>

			</nav>
		</div>
		<div class="clearfix"></div>
	</div>
<?php endif ?>